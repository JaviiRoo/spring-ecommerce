<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">
  <title>Mis Compras - MarketPlace</title>

  <!-- Bootstrap core CSS -->
  <link th:href="@{/vendor/bootstrap/css/bootstrap.min.css}" rel="stylesheet">
  <!-- Custom styles for this template -->
  <link th:href="@{/css/usuario/compras.css}" rel="stylesheet">
  <link th:href="@{/css/usuario/template_usuario.css}" rel="stylesheet">

</head>

<body>
  <!-- Navigation -->
  <div th:insert="~{usuario/template_usuario.html::header}" th:if="${sesion==null}"></div>
  <div th:insert="~{usuario/template_usuario.html::header-user}" th:unless="${sesion==null}"></div>

  <!-- Page Header -->
  <div class="page-header">
    <div class="container">
      <h1 class="page-title">
        <span>📦</span>
        <span>Mis Compras</span>
      </h1>
    </div>
  </div>

  <!-- Page Content -->
  <div class="container main-container">
    <!-- Stats Grid -->
    <div class="stats-grid" th:if="${ordenes != null and !ordenes.empty}">
      <div class="stat-card">
        <div class="stat-icon primary">📊</div>
        <div class="stat-content">
          <h4>Total Órdenes</h4>
          <p th:text="${ordenes.size()}">0</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon success">💰</div>
        <div class="stat-content">
          <h4>Total Gastado</h4>
          <p th:text="'€' + ${#aggregates.sum(ordenes.![total])}">$0</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon accent">✓</div>
        <div class="stat-content">
          <h4>Completadas</h4>
          <p th:text="${ordenes.size()}">0</p>
        </div>
      </div>
    </div>

    <!-- Filter Bar -->
    <div class="filter-bar" th:if="${ordenes != null and !ordenes.empty}">
      <div class="filter-group">
        <span class="filter-label">Mostrar:</span>
        <select class="filter-select">
          <option>Todas las órdenes</option>
          <option>Últimos 30 días</option>
          <option>Últimos 3 meses</option>
          <option>Este año</option>
        </select>
      </div>
      <div class="filter-group">
        <span class="filter-label">Estado:</span>
        <select class="filter-select">
          <option>Todos</option>
          <option>Completado</option>
          <option>En proceso</option>
          <option>Enviado</option>
        </select>
      </div>
    </div>

    <!-- Orders Card -->
    <div class="orders-card">
      <div class="orders-header">
        <div class="orders-header-left">
          <div class="orders-header-icon">🛍️</div>
          <h3>Historial de Pedidos</h3>
        </div>
        <div class="orders-count" th:if="${ordenes != null and !ordenes.empty}" th:text="${ordenes.size()} + ' pedidos'"></div>
      </div>
      <div class="card-body">
        <div th:if="${ordenes != null and !ordenes.empty}">
          <div class="table-responsive">
            <table class="orders-table">
              <thead>
                <tr>
                  <th>No. de Orden</th>
                  <th>Fecha</th>
                  <th>Valor</th>
                  <th>Estado</th>
                  <th>Acción</th>
                </tr>
              </thead>
              <tbody>
                <tr th:each="orden: ${ordenes}" class="order-item">
                  <td>
                    <div class="order-number">
                      <span class="order-badge">#</span>
                      <span th:text="${orden.numero}"></span>
                    </div>
                  </td>
                  <td>
                    <div class="order-date">
                      <span>📅</span>
                      <span th:text="${orden.fechaCreacion}"></span>
                    </div>
                  </td>
                  <td>
                    <div class="order-total" th:text="'€' + ${orden.total}"></div>
                  </td>
                  <td>
                    <span class="status-badge status-completed">
                      <span>✓</span>
                      <span>Completado</span>
                    </span>
                  </td>
                  <td>
                    <a th:href="@{/usuario/detalle/{id}(id=${orden.id})}" class="btn-view">
                      👁️ Ver Detalle
                    </a>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div th:if="${ordenes == null or ordenes.empty}" class="empty-orders">
          <div class="empty-orders-icon">🛒</div>
          <h4>Aún no tienes compras</h4>
          <p>Cuando realices tu primera compra, aparecerá aquí tu historial de pedidos</p>
          <a th:href="@{/}" class="btn-primary">
            🏪 Comenzar a Comprar
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <div th:insert="~{usuario/template_usuario.html::footer}"></div>

  <!-- Bootstrap core JavaScript -->
  <script th:src="@{/vendor/jquery/jquery.min.js}"></script>
  <script th:src="@{/vendor/bootstrap/js/bootstrap.bundle.min.js}"></script>
</body>
</html>