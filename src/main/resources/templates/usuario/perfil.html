<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mi Perfil - MarketPlace</title>
  <link th:href="@{/vendor/bootstrap/css/bootstrap.min.css}" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link th:href="@{/css/usuario/perfil.css}" rel="stylesheet">
</head>
<body>
  <!-- Floating shapes -->
  <div class="shape shape-1"></div>
  <div class="shape shape-2"></div>
  <div class="shape shape-3"></div>
  <div class="shape shape-4"></div>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-dark navbar-custom">
    <div class="container">
      <a class="logo" th:href="@{/}">
        <i class="fas fa-store"></i>
        MarketPlace
      </a>

      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link nav-link-custom" th:href="@{/}">
              <i class="fas fa-home me-1"></i>
              Inicio
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link nav-link-custom" th:href="@{/usuario/compras}">
              <i class="fas fa-shopping-bag me-1"></i>
              Mis Pedidos
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link nav-link-custom active" th:href="@{/usuario/perfil}">
              <i class="fas fa-user me-1"></i>
              Mi Perfil
            </a>
          </li>
        </ul>
      </div>    
    </div>
  </nav>

  <!-- Page Content -->
  <div class="profile-container">
    <div class="profile-wrapper">
      <div class="profile-card">
        <!-- Profile Header -->
        <div class="profile-header">
          <div class="profile-avatar">
            <i class="fas fa-user-circle"></i>
          </div>
          <div class="profile-info">
            <h1>Mi Perfil</h1>
            <p>Gestiona tu información personal y revisa tu actividad</p>
          </div>
        </div>

        <!-- Success Alert -->
        <div th:if="${param.success}" class="alert-success">
          <div class="alert-icon">
            <i class="fas fa-check-circle"></i>
          </div>
          <div class="alert-content">
            <h4>¡Éxito!</h4>
            <p>Datos actualizados correctamente ✅</p>
          </div>
        </div>

        <div class="profile-content">
          <!-- Personal Information Form -->
          <div class="form-section">
            <div class="section-header">
              <i class="fas fa-user-edit me-2"></i>
              <h3>Información Personal</h3>
            </div>
            
            <form th:action="@{/usuario/perfil/actualizar}" th:object="${usuario}" method="post" class="profile-form">
              <div class="form-grid">
                <div class="form-group">
                  <label class="form-label">
                    <i class="fas fa-user me-1"></i>
                    Nombre Completo
                  </label>
                  <div class="input-wrapper">
                    <input type="text" class="form-control" th:field="*{nombre}" placeholder="Ingresa tu nombre completo">
                    <span class="input-icon"><i class="fas fa-user"></i></span>
                  </div>
                </div>

                <div class="form-group">
                  <label class="form-label">
                    <i class="fas fa-envelope me-1"></i>
                    Correo Electrónico
                  </label>
                  <div class="input-wrapper">
                    <input type="email" class="form-control" th:field="*{email}" placeholder="tu@email.com">
                    <span class="input-icon"><i class="fas fa-envelope"></i></span>
                  </div>
                </div>

                <div class="form-group">
                  <label class="form-label">
                    <i class="fas fa-map-marker-alt me-1"></i>
                    Dirección
                  </label>
                  <div class="input-wrapper">
                    <input type="text" class="form-control" th:field="*{direccion}" placeholder="Ingresa tu dirección">
                    <span class="input-icon"><i class="fas fa-map-marker-alt"></i></span>
                  </div>
                </div>

                <div class="form-group">
                  <label class="form-label">
                    <i class="fas fa-phone me-1"></i>
                    Teléfono
                  </label>
                  <div class="input-wrapper">
                    <input type="text" class="form-control" th:field="*{telefono}" placeholder="Ingresa tu número de teléfono">
                    <span class="input-icon"><i class="fas fa-phone"></i></span>
                  </div>
                </div>
              </div>

              <button type="submit" class="btn-primary">
                <i class="fas fa-save me-2"></i>
                Actualizar Perfil
              </button>
            </form>
          </div>

          <!-- Order Summary -->
          <div class="summary-section">
            <div class="section-header">
              <i class="fas fa-chart-bar me-2"></i>
              <h3>Resumen de Actividad</h3>
            </div>
            
            <div class="stats-grid">
              <div class="stat-card">
                <div class="stat-icon">
                  <i class="fas fa-shopping-bag"></i>
                </div>
                <div class="stat-content">
                  <h4 th:text="${totalPedidos}">0</h4>
                  <p>Pedidos Realizados</p>
                </div>
              </div>
              
              <div class="stat-card">
                <div class="stat-icon">
                  <i class="fas fa-dollar-sign"></i>
                </div>
                <div class="stat-content">
                  <h4 th:text="${'€' + #numbers.formatDecimal(totalGastado, 1, 'COMMA', 2, 'POINT')}">$0.00</h4>
                  <p>Total Gastado</p>
                </div>
              </div>
              
              <div class="stat-card">
                <div class="stat-icon">
                  <i class="fas fa-star"></i>
                </div>
                <div class="stat-content">
                  <h4>Cliente</h4>
                  <p>Nivel Actual</p>
                </div>
              </div>
              
              <div class="stat-card">
                <div class="stat-icon">
                  <i class="fas fa-calendar-check"></i>
                </div>
                <div class="stat-content">
                  <h4 th:text="${#dates.format(#dates.createNow(), 'MM/yyyy')}"></h4>
                  <p>Miembro desde</p>
                </div>
              </div>
            </div>

            <div class="action-buttons">
              <a class="btn-secondary" th:href="@{/usuario/compras}">
                <i class="fas fa-list-alt me-2"></i>
                Ver Mis Pedidos
              </a>
              <button class="btn-outline">
                <i class="fas fa-shield-alt me-2"></i>
                Cambiar Contraseña
              </button>
            </div>
          </div>

          <!-- Quick Actions -->
          <div class="actions-section">
            <div class="section-header">
              <i class="fas fa-bolt me-2"></i>
              <h3>Acciones Rápidas</h3>
            </div>
            
            <div class="actions-grid">
              <a href="#" class="action-card">
                <div class="action-icon">
                  <i class="fas fa-heart"></i>
                </div>
                <div class="action-content">
                  <h5>Favoritos</h5>
                  <p>Gestiona tus productos favoritos</p>
                </div>
                <div class="action-arrow">
                  <i class="fas fa-chevron-right"></i>
                </div>
              </a>
              
              <a href="#" class="action-card">
                <div class="action-icon">
                  <i class="fas fa-bell"></i>
                </div>
                <div class="action-content">
                  <h5>Notificaciones</h5>
                  <p>Configura tus preferencias</p>
                </div>
                <div class="action-arrow">
                  <i class="fas fa-chevron-right"></i>
                </div>
              </a>
              
              <a href="#" class="action-card">
                <div class="action-icon">
                  <i class="fas fa-credit-card"></i>
                </div>
                <div class="action-content">
                  <h5>Métodos de Pago</h5>
                  <p>Gestiona tus tarjetas</p>
                </div>
                <div class="action-arrow">
                  <i class="fas fa-chevron-right"></i>
                </div>
              </a>
              
              <a href="#" class="action-card">
                <div class="action-icon">
                  <i class="fas fa-question-circle"></i>
                </div>
                <div class="action-content">
                  <h5>Soporte</h5>
                  <p>¿Necesitas ayuda?</p>
                </div>
                <div class="action-arrow">
                  <i class="fas fa-chevron-right"></i>
                </div>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer-custom">
    <div class="container text-center">
      <p>&copy; 2025 MarketPlace. Todos los derechos reservados.</p>
    </div>
  </footer>

  <!-- Bootstrap core JavaScript -->
  <script th:src="@{/vendor/jquery/jquery.min.js}"></script>
  <script th:src="@{/vendor/bootstrap/js/bootstrap.bundle.min.js}"></script>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Add focus effects to form inputs
      const inputs = document.querySelectorAll('.form-control');
      inputs.forEach(input => {
        input.addEventListener('focus', function() {
          this.parentElement.classList.add('focused');
        });
        
        input.addEventListener('blur', function() {
          if (!this.value) {
            this.parentElement.classList.remove('focused');
          }
        });
      });

      // Add animation to stat cards
      const animateStats = () => {
        const statCards = document.querySelectorAll('.stat-card');
        statCards.forEach((card, index) => {
          const cardTop = card.getBoundingClientRect().top;
          const cardVisible = 150;
          
          if (cardTop < window.innerHeight - cardVisible) {
            card.style.animationDelay = `${index * 0.1}s`;
            card.classList.add('animate-in');
          }
        });
      };

      // Initial animation
      setTimeout(animateStats, 500);
      
      // Animate on scroll
      window.addEventListener('scroll', animateStats);

      // Form submission loading state
      const profileForm = document.querySelector('.profile-form');
      const submitBtn = profileForm.querySelector('.btn-primary');
      
      profileForm.addEventListener('submit', function(e) {
        const originalText = submitBtn.innerHTML;
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Actualizando...';
        submitBtn.disabled = true;
        
        setTimeout(() => {
          submitBtn.innerHTML = originalText;
          submitBtn.disabled = false;
        }, 2000);
      });
    });
  </script>
</body>
</html>