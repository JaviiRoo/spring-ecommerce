<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">
  <title>Productos - Admin MarketPlace</title>

  <!-- Bootstrap core CSS -->
  <link th:href="@{/vendor/bootstrap/css/bootstrap.min.css}" rel="stylesheet">
  <!-- Custom styles for this template -->
  <link th:href="@{/css/productos/show.css}" rel="stylesheet">
  <link th:href="@{/css/administrador/template_admin.css}" rel="stylesheet">

</head>

<body>
  <!-- Navigation -->
  <div th:replace="administrador/template_admin.html::header"></div>

  <!-- Page Content -->
  <div class="container">
    <!-- Page Header -->
    <div class="page-header">
      <div class="page-header-left">
        <h1>
          <span>üì¶</span>
          <span>Gesti√≥n de Productos</span>
        </h1>
        <p class="page-subtitle">Administra el cat√°logo completo de productos de MarketPlace</p>
      </div>
    </div>
    
    <!-- Stats Grid -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-icon">üìä</div>
        <div class="stat-content">
          <h4>Total Productos</h4>
          <p th:text="${productos.size()}">0</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">‚úì</div>
        <div class="stat-content">
          <h4>Disponibles</h4>
          <p th:text="${productos.size()}">0</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">üí∞</div>
        <div class="stat-content">
          <h4>Valor Total</h4>
          <p th:text="'$' + ${#aggregates.sum(productos.![precio * cantidad])}">$0</p>
        </div>
      </div>
    </div>

    <!-- Actions Bar -->
    <div class="actions-bar">
      <div class="search-box">
        <span class="search-icon">üîç</span>
        <input type="text" class="search-input" id="searchInput" placeholder="Buscar productos por nombre..." onkeyup="filterTable()">
      </div>
      <a th:href="@{/productos/create}" class="btn-create">
        ‚ûï Crear Producto
      </a>
    </div>

    <!-- Table Card -->
    <div class="table-card">
      <div class="table-header">
        <h2>
          <span>üìã</span>
          <span>Lista de Productos</span>
        </h2>
        <span class="table-count" th:text="${productos.size()} + ' productos'">0 productos</span>
      </div>

      <div class="table-wrapper">
        <table class="products-table" id="productsTable">
          <thead>
            <tr>
              <th>Nombre</th>
              <th>Descripci√≥n</th>
              <th>Stock</th>
              <th>Precio</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr th:each="producto:${productos}" class="product-row">
              <td>
                <div class="product-name" th:text="${producto.nombre}">Producto</div>
              </td>
              <td>
                <div class="product-description" th:text="${producto.descripcion}" title="${producto.descripcion}">Descripci√≥n</div>
              </td>
              <td>
                <div class="product-stock">
                  <span>üì¶</span>
                  <span th:text="${producto.cantidad}">0</span>
                </div>
              </td>
              <td>
                <div class="product-price" th:text="'$' + ${producto.precio}">$0.00</div>
              </td>
              <td>
                <div class="actions-cell">
                  <a class="btn-action btn-edit" th:href="@{/productos/edit/{id} (id=${producto.id})}">
                    ‚úèÔ∏è Editar
                  </a>
                  <a class="btn-action btn-delete" th:href="@{/productos/delete/{id} (id=${producto.id})}" onclick="return confirm('¬øEst√°s seguro de eliminar este producto?')">
                    üóëÔ∏è Eliminar
                  </a>
                </div>
              </td>
            </tr>
          </tbody>
        </table>

        <div th:if="${productos.empty}" class="empty-state">
          <div class="empty-icon">üì¶</div>
          <h3>No hay productos registrados</h3>
          <p>Comienza agregando tu primer producto al cat√°logo</p>
          <a th:href="@{/productos/create}" class="btn-create">
            ‚ûï Crear Primer Producto
          </a>
        </div>
      </div>

      <div class="pagination-wrapper" th:if="${!productos.empty}">
        <div class="pagination-info">
          Mostrando <strong th:text="${productos.size()}">0</strong> productos
        </div>
        <div class="pagination">
          <button class="page-btn active">1</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <div th:replace="administrador/template_admin.html::footer"></div>

  <!-- Bootstrap core JavaScript -->
  <script th:src="@{/vendor/jquery/jquery.min.js}"></script>
  <script th:src="@{/vendor/bootstrap/js/bootstrap.bundle.min.js}"></script>

  <script>
    // Search/Filter functionality
    function filterTable() {
      const input = document.getElementById('searchInput');
      const filter = input.value.toUpperCase();
      const table = document.getElementById('productsTable');
      const rows = table.getElementsByTagName('tr');

      for (let i = 1; i < rows.length; i++) {
        const nameCell = rows[i].getElementsByTagName('td')[0];
        if (nameCell) {
          const txtValue = nameCell.textContent || nameCell.innerText;
          if (txtValue.toUpperCase().indexOf(filter) > -1) {
            rows[i].style.display = '';
          } else {
            rows[i].style.display = 'none';
          }
        }
      }
    }
  </script>
</body>
</html>