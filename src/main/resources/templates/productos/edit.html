<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">
  <title>Editar Producto - Admin MarketPlace</title>

  <!-- Bootstrap core CSS -->
  <link th:href="@{/vendor/bootstrap/css/bootstrap.min.css}" rel="stylesheet">
  <!-- Custom styles for this template -->
  <link th:href="@{/css/productos/edit.css}" rel="stylesheet">

</head>

<body>
  <!-- Navigation -->
  <div th:include="administrador/template_admin.html::header"></div>

  <!-- Page Content -->
  <div class="container">
    <!-- Page Header -->
    <div class="page-header">
      <h1 class="page-title">
        <span>‚úèÔ∏è</span>
        <span>Editar Producto</span>
        <span class="product-id-badge">ID: <span th:text="${producto.id}">123</span></span>
      </h1>
      <p class="page-subtitle">Actualiza la informaci√≥n del producto en tu cat√°logo</p>
    </div>

    <!-- Breadcrumb -->
    <nav class="breadcrumb-custom">
      <div class="breadcrumb-item">
        <a href="/admin">üè† Home</a>
      </div>
      <div class="breadcrumb-item">
        <a href="/productos">üì¶ Productos</a>
      </div>
      <div class="breadcrumb-item active">Editar Producto</div>
    </nav>

    <!-- Info Cards -->
    <div class="info-cards">
      <div class="info-card">
        <div class="info-icon">üîÑ</div>
        <div class="info-content">
          <h4>Modo</h4>
          <p>Edici√≥n</p>
        </div>
      </div>
      <div class="info-card">
        <div class="info-icon">üìù</div>
        <div class="info-content">
          <h4>Producto</h4>
          <p th:text="${producto.nombre}">Nombre</p>
        </div>
      </div>
      <div class="info-card">
        <div class="info-icon">‚ö°</div>
        <div class="info-content">
          <h4>Estado</h4>
          <p>Activo</p>
        </div>
      </div>
    </div>

    <!-- Form Card -->
    <div class="form-card">
      <div class="form-header">
        <div class="form-header-icon">‚úèÔ∏è</div>
        <div class="form-header-content">
          <h2>Actualizar Informaci√≥n</h2>
          <p>Modifica los campos que necesites cambiar</p>
          <div class="alert-badge">‚ö†Ô∏è Los cambios se aplicar√°n inmediatamente</div>
        </div>
      </div>

      <div class="form-body">
        <form th:action="@{/productos/update}" method="post" enctype="multipart/form-data">
          <input type="hidden" name="id" th:value="${producto.id}">
          
          <!-- Basic Information Section -->
          <div class="form-section">
            <h3 class="section-title">
              <span class="section-icon">üìã</span>
              Informaci√≥n B√°sica
            </h3>
            
            <div class="form-group">
              <label class="form-label" for="nombre">
                Nombre del Producto
                <span class="required-badge">REQUERIDO</span>
              </label>
              <input type="text" 
                     class="form-control-custom" 
                     id="nombre" 
                     name="nombre"
                     placeholder="Ej: Smartphone Samsung Galaxy S24"
                     th:value="${producto.nombre}"
                     autocomplete="off" 
                     required>
              <div class="help-text">
                <span class="help-icon">i</span>
                <span>Ingrese un nombre claro y descriptivo para el producto</span>
              </div>
            </div>

            <div class="form-group">
              <label class="form-label" for="descripcion">
                Descripci√≥n
                <span class="required-badge">REQUERIDO</span>
              </label>
              <textarea class="form-control-custom" 
                        id="descripcion" 
                        name="descripcion"
                        placeholder="Describa las caracter√≠sticas principales..."
                        required
                        autocomplete="off"
                        th:text="${producto.descripcion}"></textarea>
              <div class="help-text">
                <span class="help-icon">i</span>
                <span>Proporcione detalles que ayuden a los clientes a tomar su decisi√≥n</span>
              </div>
            </div>
          </div>

          <!-- Inventory Section -->
          <div class="form-section">
            <h3 class="section-title">
              <span class="section-icon">üìä</span>
              Inventario y Precio
            </h3>
            
            <div class="input-grid">
              <div class="form-group">
                <label class="form-label" for="cantidad">
                  Cantidad en Stock
                  <span class="required-badge">REQUERIDO</span>
                </label>
                <input type="number" 
                       class="form-control-custom" 
                       id="cantidad"
                       name="cantidad" 
                       placeholder="100"
                       th:value="${producto.cantidad}"
                       min="0"
                       required 
                       autocomplete="off">
                <div class="help-text">
                  <span class="help-icon">i</span>
                  <span>Unidades disponibles en inventario</span>
                </div>
              </div>

              <div class="form-group">
                <label class="form-label" for="precio">
                  Precio (USD)
                  <span class="required-badge">REQUERIDO</span>
                </label>
                <input type="number" 
                       class="form-control-custom" 
                       step="0.01" 
                       id="precio" 
                       name="precio"
                       placeholder="99.99"
                       th:value="${producto.precio}"
                       min="0"
                       autocomplete="off" 
                       required>
                <div class="help-text">
                  <span class="help-icon">i</span>
                  <span>Precio de venta del producto</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Image Section -->
          <div class="form-section">
            <h3 class="section-title">
              <span class="section-icon">üñºÔ∏è</span>
              Imagen del Producto
            </h3>
            
            <div class="form-group">
              <label class="form-label" for="img">
                Cambiar Imagen
              </label>
              
              <div class="current-image" th:if="${producto.imagen}">
                <span class="current-image-label">Imagen Actual:</span>
                <div class="current-image-name">
                  <span>üì∑</span>
                  <span th:text="${producto.imagen}">imagen-actual.jpg</span>
                </div>
              </div>
              
              <div class="file-upload-wrapper" id="fileUploadWrapper">
                <div class="file-upload-icon">üì∏</div>
                <div class="file-upload-text">Arrastra una nueva imagen aqu√≠ o haz clic</div>
                <div class="file-upload-hint">Formatos: JPG, PNG, WEBP (M√°x. 5MB) - Opcional</div>
                <input type="file" 
                       class="file-input" 
                       id="img" 
                       name="img"
                       accept="image/*"
                       onchange="displayFileName(this)">
                <div class="file-name" id="fileName"></div>
              </div>
              <div class="help-text">
                <span class="help-icon">i</span>
                <span>Solo sube una nueva imagen si quieres reemplazar la actual</span>
              </div>
            </div>
          </div>

          <!-- Form Actions -->
          <div class="form-actions">
            <button type="submit" class="btn-custom btn-primary">
              üíæ Actualizar Producto
            </button>
            <a href="/productos" class="btn-custom btn-secondary">
              ‚úï Cancelar
            </a>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <div th:include="administrador/template_admin.html::footer"></div>

  <!-- Bootstrap core JavaScript -->
  <script th:src="@{/vendor/jquery/jquery.min.js}"></script>
  <script th:src="@{/vendor/bootstrap/js/bootstrap.bundle.min.js}"></script>

  <script>
    // Display selected file name
    function displayFileName(input) {
      const fileName = document.getElementById('fileName');
      if (input.files && input.files[0]) {
        fileName.textContent = '‚úì Nueva imagen: ' + input.files[0].name;
        fileName.classList.add('show');
      }
    }

    // Drag and drop functionality
    const fileUploadWrapper = document.getElementById('fileUploadWrapper');
    const fileInput = document.getElementById('img');

    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
      fileUploadWrapper.addEventListener(eventName, preventDefaults, false);
    });

    function preventDefaults(e) {
      e.preventDefault();
      e.stopPropagation();
    }

    ['dragenter', 'dragover'].forEach(eventName => {
      fileUploadWrapper.addEventListener(eventName, () => {
        fileUploadWrapper.classList.add('dragover');
      }, false);
    });

    ['dragleave', 'drop'].forEach(eventName => {
      fileUploadWrapper.addEventListener(eventName, () => {
        fileUploadWrapper.classList.remove('dragover');
      }, false);
    });

    fileUploadWrapper.addEventListener('drop', (e) => {
      const dt = e.dataTransfer;
      const files = dt.files;
      fileInput.files = files;
      displayFileName(fileInput);
    }, false);
  </script>
</body>
</html>